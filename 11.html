<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>مقابلة قانونية</title>
  <!-- html2pdf.js لتحويل HTML إلى PDF مع دعم UTF-8 -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <!-- خط Cairo للنص العربي -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Cairo', sans-serif;
      background-color: #f0f2f5;
      direction: rtl;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 800px;
      width: 95%;
      margin: 40px auto;
      background: #ffffff;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.1);
    }
    h3 {
      color: #1f2a57;
      margin-bottom: 20px;
      text-align: center;
      font-size: 24px;
    }
    label {
      font-weight: 700;
      margin-top: 15px;
      display: block;
      color: #333;
      font-size: 14px;
    }
    input, textarea {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      margin-bottom: 15px;
      border: 1px solid #ccd0d5;
      border-radius: 6px;
      font-size: 14px;
      box-sizing: border-box;
    }
    textarea { resize: vertical; }
    button {
      background: #4a69bd;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 12px 24px;
      cursor: pointer;
      font-size: 15px;
      transition: background 0.2s;
      display: block;
      margin: 20px auto;
    }
    button:hover { background: #3b4a99; }
    /* محتوى PDF مخفي */
    #pdfContent {
      display: none;
      font-family: 'Cairo', sans-serif;
      background: #ffffff;
      padding: 20mm;
      box-sizing: border-box;
      width: 210mm;
      min-height: 297mm;
    }
    #pdfContent .pdf-header {
      background: linear-gradient(90deg, #4a69bd, #6a89cc);
      color: #ffffff;
      padding: 10px;
      border-radius: 8px;
      text-align: center;
      font-size: 22pt;
      margin-bottom: 15pt;
      page-break-after: avoid;
    }
    #pdfContent .user-info {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10pt;
      background: #eef1fa;
      padding: 10pt;
      border-radius: 6pt;
      margin-bottom: 20pt;
      font-size: 11pt;
      page-break-inside: avoid;
    }
    #pdfContent .user-info div { }
    #pdfContent .qa-card {
      background: #f9f9fb;
      border-left: 4pt solid #4a69bd;
      padding: 10pt;
      margin-bottom: 15pt;
      border-radius: 4pt;
      page-break-inside: avoid;
    }
    #pdfContent .qa-card .question {
      font-size: 13pt;
      font-weight: bold;
      color: #2d3e50;
      margin-bottom: 6pt;
    }
    #pdfContent .qa-card .answer {
      font-size: 12pt;
      color: #333;
      line-height: 1.5;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <div class="container" id="userForm">
    <h3>البيانات الشخصية</h3>
    <label for="fullName">الاسم الكامل:</label>
    <input type="text" id="fullName" placeholder="الاسم الكامل" required>
    <label for="phone">رقم الجوال:</label>
    <input type="text" id="phone" inputmode="numeric" maxlength="10" placeholder="05XXXXXXXX"
           oninput="this.value=this.value.replace(/[^0-9]/g,'')" required>
    <label for="expectedSalary">الراتب المتوقع:</label>
    <input type="text" id="expectedSalary" inputmode="numeric" maxlength="5" placeholder="الراتب المتوقع"
           oninput="this.value=this.value.replace(/[^0-9]/g,'')" required>
    <button onclick="validateAndStart()">بدء المقابلة</button>
  </div>

  <div class="container" id="interview" style="display:none;">
    <h3>مقابلة قانونية</h3>
    <div id="questions"></div>
    <button onclick="preparePdf()">تحميل الإجابات PDF</button>
  </div>

  <div class="container" id="thanks" style="display:none; text-align:center;">
    <h3>شكرًا لمشاركتك!</h3>
    <p>تم تحميل إجاباتك بنجاح.</p>
  </div>

  <!-- محتوى PDF مخفي -->
  <div id="pdfContent">
    <div class="pdf-header">مقابلة قانونية - إجابات المتقدم</div>
    <div class="user-info">
      <div>الاسم: <strong id="pdfName"></strong></div>
      <div>الجوال: <strong id="pdfPhone"></strong></div>
      <div>الراتب المتوقع: <strong id="pdfSalary"></strong></div>
    </div>
    <div id="pdfQuestions"></div>
  </div>

  <script>
    let userName = '', userPhone = '', userSalary = '';
    const questions = [
      "1- ما هي آلية إدارة شركة ذات مسؤولية محدودة متعددة الشركاء والمدراء إذا لم ينص عقد التأسيس على ذلك، ولا يوجد مجلس مدراء، مع تساوي نسب الشركاء وعدم إمكانية التوافق بينهم؟",
      "2- هل أجاز النظام لمدير الشركة تحرير سند لأمر أو شيك لنفسه؟ وما هو المسوغ النظامي لذلك؟",
      "3- هل يجوز لأحد الشركاء، إن كان مديناً لشركة هو شريك بها، أن يتقدم لقاضي التنفيذ بالحجز على حصصه في الشركة للوفاء بالدين الذي في ذمته للشركة؟"
    ];

    function validateAndStart() {
      userName = document.getElementById('fullName').value.trim();
      userPhone = document.getElementById('phone').value.trim();
      userSalary = document.getElementById('expectedSalary').value.trim();
      if (!userName || !userPhone || !userSalary) { alert('يرجى تعبئة جميع الحقول.'); return; }
      if (!/^05\d{8}$/.test(userPhone)) { alert('رقم الجوال يجب أن يتكون من 10 أرقام ويبدأ بـ05.'); return; }
      if (!/^\d{1,5}$/.test(userSalary)) { alert('الراتب المتوقع يجب أن يكون رقماً ولا يزيد عن 5 أرقام.'); return; }
      document.getElementById('userForm').style.display = 'none';
      document.getElementById('interview').style.display = 'block';
      startInterview();
    }

    function startInterview() {
      const container = document.getElementById('questions');
      container.innerHTML = '';
      questions.forEach((q, i) => {
        const label = document.createElement('label');
        label.textContent = q;
        const textarea = document.createElement('textarea');
        textarea.id = `q${i}`;
        textarea.rows = 4;
        container.appendChild(label);
        container.appendChild(textarea);
      });
    }

    function preparePdf() {
      document.getElementById('pdfName').textContent = userName;
      document.getElementById('pdfPhone').textContent = userPhone;
      document.getElementById('pdfSalary').textContent = userSalary;
      let html = '';
      questions.forEach((q, i) => {
        const ans = document.getElementById(`q${i}`).value || '-';
        html += `<div class="qa-card"><div class="question">${q}</div><div class="answer">${ans}</div></div>`;
      });
      document.getElementById('pdfQuestions').innerHTML = html;
      const element = document.getElementById('pdfContent');
      element.style.display = 'block';
      const opt = {
        margin: 10,
        filename: 'الإجابات.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2, useCORS: true },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
        pagebreak: { mode: ['css', 'legacy'] }
      };
      html2pdf().set(opt).from(element).save().then(() => {
        element.style.display = 'none';
        document.getElementById('interview').style.display = 'none';
        document.getElementById('thanks').style.display = 'block';
      });
    }
  </script>
</body>
</html>
